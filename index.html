<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dachshund Detective</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <style>
        :root { 
            --primary: #5d4037; --accent: #ff9800; 
            --bg: linear-gradient(180deg, #1a1a1a 0%, #2d1f1a 100%); 
            --text: #ffffff;
        }
        body { margin: 0; background: var(--bg); font-family: 'Segoe UI', sans-serif; color: var(--text); display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        #header { padding: 15px; background: rgba(0,0,0,0.3); text-align: center; border-bottom: 1px solid rgba(255,255,255,0.1); }
        #balance { font-size: 32px; font-weight: 800; margin: 5px 0; }
        
        .page { display: none; flex-direction: column; align-items: center; justify-content: center; flex-grow: 1; width: 100%; padding: 20px; box-sizing: border-box; }
        .page.active { display: flex; }

        /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –∫–æ—à–µ–ª—å–∫–∞ */
        #ton-connect-button { 
            display: flex; 
            justify-content: center; 
            min-height: 44px; 
            width: 100%;
            margin-top: 20px;
        }

        .hero-img { width: 220px; height: 220px; object-fit: contain; cursor: pointer; transition: transform 0.05s; }
        .hero-img:active { transform: scale(0.95); }

        #nav { width: 100%; display: flex; background: rgba(0,0,0,0.5); padding: 10px 0 25px; }
        .nav-btn { flex: 1; text-align: center; font-size: 11px; opacity: 0.5; color: white; cursor: pointer; }
        .nav-btn.active { opacity: 1; color: var(--accent); }
    </style>
</head>
<body>

    <div id="header">
        <div id="rank-info"><span id="player-name">–î–µ—Ç–µ–∫—Ç–∏–≤</span></div>
        <div id="balance">ü¶¥ <span id="coins">0</span></div>
    </div>

    <div id="tab-game" class="page active">
        <img src="https://i.ibb.co/XfXfXfX/dachshund.png" class="hero-img" onclick="handleTap(event)">
        <p>‚ö° –≠–Ω–µ—Ä–≥–∏—è: <span id="energy-text">1000/1000</span></p>
    </div>

    <div id="tab-shop" class="page">
        <h3>–ú–∞–≥–∞–∑–∏–Ω</h3>
        <button onclick="buyUpgrade(50, 1)">–õ—É–ø–∞ (50 ü¶¥)</button>
    </div>

    <div id="tab-wallet" class="page">
        <h3>–ö–æ—à–µ–ª–µ–∫</h3>
        <p>–ü–æ–¥–∫–ª—é—á–∏—Ç–µ TON –∫–æ—à–µ–ª–µ–∫ –¥–ª—è –≤—ã–ø–ª–∞—Ç</p>
        <div id="ton-connect-button"></div>
    </div>

    <div id="nav">
        <div class="nav-btn active" onclick="showTab(0)">üè† –ò–≥—Ä–∞</div>
        <div class="nav-btn" onclick="showTab(1)">üõ† –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è</div>
        <div class="nav-btn" onclick="showTab(3)">üíé –ö–æ—à–µ–ª–µ–∫</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const user = tg.initDataUnsafe?.user;
        const accountKey = user ? `user_${user.id}` : "guest_account";
        document.getElementById('player-name').innerText = user ? user.first_name : "–î–µ—Ç–µ–∫—Ç–∏–≤";

        let balance = 0, energy = 1000, pps = 0;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è TON Connect UI
        const tonConnectUI = new TonConnectUI.TonConnectUI({
            manifestUrl: 'https://dimazmlbig-dev.github.io/zootopia-clicker/tonconnect-manifest.json',
            buttonRootId: 'ton-connect-button'
        });

        function handleTap(e) {
            if (energy > 0) {
                balance++; energy--;
                tg.HapticFeedback.impactOccurred('medium');
                updateUI();
            }
        }

        function updateUI() {
            document.getElementById('coins').innerText = Math.floor(balance);
            document.getElementById('energy-text').innerText = `${energy}/1000`;
        }

        function showTab(index) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            
            const tabs = ['tab-game', 'tab-shop', '', 'tab-wallet'];
            const activeTabId = tabs[index];
            if(activeTabId) document.getElementById(activeTabId).classList.add('active');
            
            const btnIdx = index === 3 ? 2 : index;
            document.querySelectorAll('.nav-btn')[btnIdx].classList.add('active');
        }

        function saveData() {
            localStorage.setItem(accountKey, JSON.stringify({balance, energy, pps}));
        }

        setInterval(() => {
            balance += pps;
            if (energy < 1000) energy++;
            updateUI();
            saveData();
        }, 1000);

        updateUI();
    </script>
</body>
</html>




