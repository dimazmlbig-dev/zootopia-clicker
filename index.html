<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Zootopia: Final Edition</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üê∂</text></svg>">
    
    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- TON Connect UI -->
    <script src="https://unpkg.com/@tonconnect/ui@2.0.3/dist/tonconnect-ui.min.js"></script>
    
    <!-- Font Awesome -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    
    <style>
        /* –í–ê–® –°–¢–ò–õ–¨ (–æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) */
        /* ... –≤–µ—Å—å CSS –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –æ—Ç–≤–µ—Ç–∞ ... */
    </style>
</head>
<body>

<!-- –ó–∞–≥—Ä—É–∑—á–∏–∫ -->
<div class="loader" id="loader">
    <div class="loader-spinner"></div>
    <div>–ó–∞–≥—Ä—É–∑–∫–∞ Zootopia...</div>
</div>

<!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
<div class="notification" id="notification"></div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π -->
<div class="modal" id="achievement-modal">
    <div class="modal-content">
        <h2>üéâ –ù–æ–≤–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ!</h2>
        <p id="achievement-text"></p>
        <button class="btn-action" onclick="hideModal('achievement-modal')" style="width: 100%; margin-top: 20px;">
            –û—Ç–ª–∏—á–Ω–æ!
        </button>
    </div>
</div>

<!-- –í–ê–® HTML (–æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) -->
<!-- ... –≤–µ—Å—å HTML –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –æ—Ç–≤–µ—Ç–∞ ... -->

<script>
    // ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
    let tg = null;
    let tonConnectUI = null;
    let lastTapTime = 0;
    let gameScore = 0;
    let dailyRewardsClaimed = [];
    let achievements = [];
    
    // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
    let state = {
        bones: 1000, // –ù–∞—á–∞–ª—å–Ω—ã–µ –∫–æ—Å—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        zoo: 0.5000, // –ù–∞—á–∞–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        energy: 1000,
        tapLvl: 1,
        energyLvl: 1,
        ownedNFTs: [],
        level: 1,
        exp: 0,
        achievements: [],
        gameHighScore: 0,
        referralCode: '',
        referrals: 0
    };
    
    // –¶–µ–Ω—ã —É–ª—É—á—à–µ–Ω–∏–π
    const upgradeCosts = {
        tap: [500, 1000, 2000, 4000, 8000, 16000, 32000, 64000, 128000, 256000],
        energy: [1000, 2000, 4000, 8000, 16000, 32000, 64000, 128000, 256000, 512000]
    };
    
    // –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã
    const dailyRewards = [100, 200, 300, 500, 800, 1300, 2100];
    
    // –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
    const achievementList = [
        { id: 'first_tap', name: '–ü–µ—Ä–≤—ã–π –∫–ª–∏–∫!', desc: '–°–¥–µ–ª–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –∫–ª–∏–∫', goal: 1, reward: 100 },
        { id: '100_clicks', name: '–ù–∞—á–∞–ª–æ –ø—É—Ç–∏', desc: '–°–¥–µ–ª–∞–π—Ç–µ 100 –∫–ª–∏–∫–æ–≤', goal: 100, reward: 500 },
        { id: '1000_clicks', name: '–£–≤–µ—Ä–µ–Ω–Ω—ã–π –∫–ª–∏–∫–µ—Ä', desc: '–°–¥–µ–ª–∞–π—Ç–µ 1000 –∫–ª–∏–∫–æ–≤', goal: 1000, reward: 2000 },
        { id: '10000_clicks', name: '–ú–∞—Å—Ç–µ—Ä –∫–ª–∏–∫–æ–≤', desc: '–°–¥–µ–ª–∞–π—Ç–µ 10000 –∫–ª–∏–∫–æ–≤', goal: 10000, reward: 10000 },
        { id: 'first_upgrade', name: '–ü–µ—Ä–≤—ã–π –∞–ø–≥—Ä–µ–π–¥', desc: '–£–ª—É—á—à–∏—Ç–µ —Å–∏–ª—É —Ç–∞–ø–∞', goal: 1, reward: 200 },
        { id: 'first_nft', name: '–ú–æ–¥–Ω–∏–∫', desc: '–ö—É–ø–∏—Ç–µ –ø–µ—Ä–≤—ã–π NFT', goal: 1, reward: 500 },
        { id: 'level_10', name: '–û–ø—ã—Ç–Ω—ã–π –∏–≥—Ä–æ–∫', desc: '–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 10 —É—Ä–æ–≤–Ω—è', goal: 10, reward: 5000 },
        { id: 'level_20', name: '–í–µ—Ç–µ—Ä–∞–Ω', desc: '–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 20 —É—Ä–æ–≤–Ω—è', goal: 20, reward: 15000 },
        { id: 'rich', name: '–ë–æ–≥–∞—á', desc: '–ù–∞–∫–æ–ø–∏—Ç–µ 100 $ZOO', goal: 100, reward: 10000 },
        { id: 'referral_master', name: '–°–æ—Ü–∏–∞–ª—å–Ω–∞—è –±–∞–±–æ—á–∫–∞', desc: '–ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ 5 –¥—Ä—É–∑–µ–π', goal: 5, reward: 5000 }
    ];
    
    // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
    document.addEventListener('DOMContentLoaded', function() {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        try {
            tg = window.Telegram?.WebApp;
            if (tg) {
                tg.ready();
                tg.expand();
                tg.enableClosingConfirmation();
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º—É Telegram
                document.documentElement.style.setProperty('--tg-theme-bg-color', tg.themeParams.bg_color || '#1A5CC7');
                document.documentElement.style.setProperty('--tg-theme-text-color', tg.themeParams.text_color || '#ffffff');
                document.documentElement.style.setProperty('--tg-theme-hint-color', tg.themeParams.hint_color || '#aaaaaa');
                document.documentElement.style.setProperty('--tg-theme-link-color', tg.themeParams.link_color || '#FFD700');
                document.documentElement.style.setProperty('--tg-theme-button-color', tg.themeParams.button_color || '#FFD700');
                document.documentElement.style.setProperty('--tg-theme-button-text-color', tg.themeParams.button_text_color || '#1A5CC7');
                
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const user = tg.initDataUnsafe?.user;
                if (user) {
                    console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Telegram:', user);
                    state.referralCode = 'ref_' + (user.id || Date.now()).toString().slice(-8);
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
                    setTimeout(() => {
                        showNotification(`–ü—Ä–∏–≤–µ—Ç, ${user.first_name || '–¥—Ä—É–≥'}! üëã`, 'success');
                    }, 1000);
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ—Ñ–µ—Ä–∞–ª–∞
                    const startParam = tg.initDataUnsafe?.start_param;
                    if (startParam && startParam.startsWith('ref_')) {
                        handleReferral(startParam);
                    }
                }
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥"
                tg.BackButton.onClick(() => {
                    if (document.getElementById('tab-daily').classList.contains('active')) {
                        showTab('tab-main');
                    }
                });
            }
        } catch (e) {
            console.log('–ù–µ –≤ Telegram –∏–ª–∏ –æ—à–∏–±–∫–∞:', e);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è TON Connect —Å –í–ê–®–ò–ú –º–∞–Ω–∏—Ñ–µ—Å—Ç–æ–º
        try {
            tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
                manifestUrl: 'https://dimazmlbig-dev.github.io/zootopia-clicker/tonconnect-manifest.json',
                buttonRootId: 'ton-connect-button',
                language: 'ru',
                uiPreferences: {
                    theme: 'DARK',
                    colorsSet: {
                        [TON_CONNECT_UI.COLORS_SET.LIGHT]: {
                            connectButton: {
                                background: '#FFD700',
                                foreground: '#1A5CC7'
                            }
                        }
                    }
                }
            });
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–π –∫–æ—à–µ–ª–µ–∫
            tonConnectUI.connectionRestored.then((connected) => {
                if (connected) {
                    console.log('TON –∫–æ—à–µ–ª–µ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω');
                    updateWalletInfo();
                }
            });
            
            // –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
            tonConnectUI.onStatusChange((wallet) => {
                if (wallet) {
                    console.log('–ö–æ—à–µ–ª–µ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω:', wallet);
                    updateWalletInfo();
                    showNotification('TON –∫–æ—à–µ–ª–µ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω!', 'success');
                } else {
                    console.log('–ö–æ—à–µ–ª–µ–∫ –æ—Ç–∫–ª—é—á–µ–Ω');
                }
            });
            
        } catch (e) {
            console.log('–û—à–∏–±–∫–∞ TON Connect:', e);
            showNotification('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ—à–µ–ª—å–∫–∞', 'error');
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –∏–≥—Ä—ã
        loadGame();
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∏–Ω–∏-–∏–≥—Ä—ã
        initGame();
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –Ω–∞–≥—Ä–∞–¥
        loadDailyRewards();
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
        updateUI();
        
        // –°–∫—Ä—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑—á–∏–∫
        setTimeout(() => {
            document.getElementById('loader').classList.add('hidden');
        }, 1000);
        
        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏
        setInterval(restoreEnergy, 1000);
        
        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        setInterval(saveGame, 30000);
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å–µ–∫—Ü–∏—é –µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–¥
        if (state.referralCode) {
            document.getElementById('referral-section').style.display = 'block';
            document.getElementById('referral-link').textContent = 
                `https://t.me/ZootopiaGameBot/app?startapp=${state.referralCode}`;
        }
    });
    
    // ==================== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
    
    function handleTap(event) {
        const now = Date.now();
        if (now - lastTapTime < 50) return; // –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞
        lastTapTime = now;
        
        if (state.energy >= 2) {
            // –ê–Ω–∏–º–∞—Ü–∏—è –∫–ª–∏–∫–∞
            createTapAnimation(event);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
            const tapPower = getTapPower();
            state.bones += tapPower;
            state.zoo += (tapPower * 0.0001);
            state.energy -= 2;
            state.exp += tapPower;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
            checkAchievements();
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–≤–æ–ª—é—Ü–∏–∏
            checkEvolution();
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ä–æ–≤–Ω—è
            checkLevelUp();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            updateUI();
            
            // –í–∏–±—Ä–∞—Ü–∏—è (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
            try {
                if (tg?.HapticFeedback) {
                    tg.HapticFeedback.impactOccurred('light');
                }
            } catch (e) {}
        } else {
            showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏!', 'warning');
        }
    }
    
    function createTapAnimation(event) {
        const anim = document.createElement('div');
        anim.className = 'tap-animation';
        anim.innerText = '+' + getTapPower();
        anim.style.color = getRandomColor();
        
        // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
        const x = event.clientX || window.innerWidth / 2;
        const y = event.clientY || window.innerHeight / 2;
        
        anim.style.left = (x - 20) + 'px';
        anim.style.top = (y - 20) + 'px';
        
        document.body.appendChild(anim);
        setTimeout(() => anim.remove(), 1000);
    }
    
    function getRandomColor() {
        const colors = ['#FFD700', '#FF8D29', '#FF5252', '#4CAF50', '#2196F3', '#9C27B0'];
        return colors[Math.floor(Math.random() * colors.length)];
    }
    
    function getTapPower() {
        return state.tapLvl * (state.tapLvl < 5 ? 1 : state.tapLvl < 10 ? 2 : state.tapLvl < 15 ? 3 : 5);
    }
    
    function upgradeTap() {
        const cost = upgradeCosts.tap[state.tapLvl - 1] || state.tapLvl * 500;
        
        if (state.bones >= cost) {
            state.bones -= cost;
            state.tapLvl++;
            
            // –ê–Ω–∏–º–∞—Ü–∏—è —É–ª—É—á—à–µ–Ω–∏—è
            document.getElementById('pet-img').style.animation = 'none';
            setTimeout(() => {
                document.getElementById('pet-img').style.animation = 'pulse 0.5s';
            }, 10);
            
            showNotification(`–°–∏–ª–∞ —Ç–∞–ø–∞ —É–ª—É—á—à–µ–Ω–∞ –¥–æ —É—Ä–æ–≤–Ω—è ${state.tapLvl}!`, 'success');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
            if (state.tapLvl === 2 && !state.achievements.includes('first_upgrade')) {
                unlockAchievement('first_upgrade');
            }
            
            updateUI();
            saveGame();
        } else {
            showNotification(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫–æ—Å—Ç–µ–π! –ù—É–∂–Ω–æ: ${cost.toLocaleString()} ü¶¥`, 'error');
        }
    }
    
    function upgradeEnergy() {
        const cost = upgradeCosts.energy[state.energyLvl - 1] || state.energyLvl * 1000;
        
        if (state.bones >= cost) {
            state.bones -= cost;
            state.energyLvl++;
            
            showNotification(`–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ —É–ª—É—á—à–µ–Ω–æ –¥–æ —É—Ä–æ–≤–Ω—è ${state.energyLvl}!`, 'success');
            updateUI();
            saveGame();
        } else {
            showNotification(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫–æ—Å—Ç–µ–π! –ù—É–∂–Ω–æ: ${cost.toLocaleString()} ü¶¥`, 'error');
        }
    }
    
    function restoreEnergy() {
        if (state.energy < 1000) {
            const restoreRate = 1 + (state.energyLvl * 0.5);
            state.energy = Math.min(1000, state.energy + restoreRate);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —ç–Ω–µ—Ä–≥–∏–∏
            document.getElementById('en-cur').textContent = Math.floor(state.energy);
            document.getElementById('en-fill').style.width = (state.energy / 10) + '%';
        }
    }
    
    function buyNFT(id, price) {
        if (state.zoo >= price && !state.ownedNFTs.includes(id)) {
            state.zoo -= price;
            state.ownedNFTs.push(id);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º NFT –Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ
            const overlay = document.getElementById(`nft-${id}`);
            if (overlay) {
                overlay.classList.add('visible');
                overlay.style.animation = 'pulse 0.5s';
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É
            const button = document.getElementById(`buy-${id}`);
            if (button) {
                button.innerHTML = '<i class="fas fa-check"></i> –ù–∞–¥–µ—Ç–æ';
                button.disabled = true;
                button.style.background = 'linear-gradient(135deg, #4CAF50, #2E7D32)';
            }
            
            showNotification(`NFT "${getNFTName(id)}" –∫—É–ø–ª–µ–Ω –∏ –Ω–∞–¥–µ—Ç!`, 'success');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
            if (!state.achievements.includes('first_nft')) {
                unlockAchievement('first_nft');
            }
            
            updateUI();
            saveGame();
        } else if (state.ownedNFTs.includes(id)) {
            showNotification('–≠—Ç–æ—Ç NFT —É–∂–µ –∫—É–ø–ª–µ–Ω!', 'warning');
        } else {
            showNotification(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ $ZOO! –ù—É–∂–Ω–æ: ${price} $ZOO`, 'error');
        }
    }
    
    function getNFTName(id) {
        const names = {
            'glasses': '–û—á–∫–∏ Cyber',
            'hat': '–®–ª—è–ø–∞ Gentleman',
            'crown': '–ö–æ—Ä–æ–Ω–∞ –ö–æ—Ä–æ–ª—è'
        };
        return names[id] || id;
    }
    
    function checkEvolution() {
        const label = document.getElementById('evo-label');
        if (state.tapLvl >= 15) {
            label.innerHTML = 'ü§ñ –ö–∏–±–µ—Ä-–¢–∞–∫—Å–∞ <small style="font-size:12px;">(–£—Ä–æ–≤–µ–Ω—å 15+)</small>';
        } else if (state.tapLvl >= 10) {
            label.innerHTML = 'ü¶∏ –¢–∞–∫—Å–∞-–°—É–ø–µ—Ä–≥–µ—Ä–æ–π <small style="font-size:12px;">(–£—Ä–æ–≤–µ–Ω—å 10+)</small>';
        } else if (state.tapLvl >= 5) {
            label.innerHTML = 'üí™ –°–∏–ª—å–Ω–∞—è –¢–∞–∫—Å–∞ <small style="font-size:12px;">(–£—Ä–æ–≤–µ–Ω—å 5+)</small>';
        } else {
            label.innerHTML = 'üê∂ –ú–∞–ª—ã—à –¢–∞–∫—Å–∞ <small style="font-size:12px;">(–£—Ä–æ–≤–µ–Ω—å 1)</small>';
        }
    }
    
    function checkLevelUp() {
        const expNeeded = state.level * 1000;
        if (state.exp >= expNeeded) {
            state.level++;
            state.exp = state.exp - expNeeded;
            
            // –ê–Ω–∏–º–∞—Ü–∏—è —É—Ä–æ–≤–Ω—è
            document.querySelector('.score').style.animation = 'none';
            setTimeout(() => {
                document.querySelector('.score').style.animation = 'pulse 0.5s';
            }, 10);
            
            showNotification(`üéâ –ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å: ${state.level}!`, 'success');
            
            // –ù–∞–≥—Ä–∞–¥–∞ –∑–∞ —É—Ä–æ–≤–µ–Ω—å
            const levelReward = state.level * 500;
            state.bones += levelReward;
            state.zoo += state.level * 0.01;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            if (state.level === 10 && !state.achievements.includes('level_10')) {
                unlockAchievement('level_10');
            }
            if (state.level === 20 && !state.achievements.includes('level_20')) {
                unlockAchievement('level_20');
            }
            
            updateUI();
        }
    }
    
    // ==================== –°–ò–°–¢–ï–ú–ê –î–û–°–¢–ò–ñ–ï–ù–ò–ô ====================
    
    function checkAchievements() {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ –∫–ª–∏–∫–∞–º
        const totalClicks = Math.floor(state.bones / getTapPower());
        
        achievementList.forEach(achievement => {
            if (state.achievements.includes(achievement.id)) return;
            
            let unlocked = false;
            
            switch(achievement.id) {
                case 'first_tap':
                    unlocked = totalClicks >= 1;
                    break;
                case '100_clicks':
                    unlocked = totalClicks >= 100;
                    break;
                case '1000_clicks':
                    unlocked = totalClicks >= 1000;
                    break;
                case '10000_clicks':
                    unlocked = totalClicks >= 10000;
                    break;
                case 'first_upgrade':
                    unlocked = state.tapLvl > 1;
                    break;
                case 'rich':
                    unlocked = state.zoo >= 100;
                    break;
                case 'referral_master':
                    unlocked = state.referrals >= 5;
                    break;
            }
            
            if (unlocked) {
                unlockAchievement(achievement.id);
            }
        });
    }
    
    function unlockAchievement(achievementId) {
        const achievement = achievementList.find(a => a.id === achievementId);
        if (!achievement) return;
        
        state.achievements.push(achievementId);
        state.bones += achievement.reward;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        document.getElementById('achievement-text').innerHTML = 
            `<h3>${achievement.name}</h3>
             <p>${achievement.desc}</p>
             <p style="color: var(--gold); font-weight: bold; margin-top: 10px;">
                –ù–∞–≥—Ä–∞–¥–∞: ${achievement.reward.toLocaleString()} ü¶¥
             </p>`;
        showModal('achievement-modal');
        
        showNotification(`üéâ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: ${achievement.name}`, 'success');
        saveGame();
    }
    
    // ==================== –ú–ò–ù–ò-–ò–ì–†–ê ====================
    
    function initGame() {
        const grid = document.getElementById('grid');
        if (!grid) return;
        
        grid.innerHTML = '';
        gameScore = 0;
        
        // –°–æ–∑–¥–∞–µ–º —Å–µ—Ç–∫—É 5x5 —Å —Ä–∞–∑–Ω—ã–º–∏ —ç–º–æ–¥–∑–∏
        const emojis = ['ü¶¥', 'üê∂', 'üêæ', 'üåü', 'üíé', 'üéØ'];
        
        for (let i = 0; i < 25; i++) {
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.innerHTML = emojis[Math.floor(Math.random() * emojis.length)];
            cell.dataset.value = cell.innerHTML;
            cell.onclick = () => handleGameCellClick(cell, i);
            grid.appendChild(cell);
        }
        
        document.getElementById('game-score').textContent = gameScore;
        document.getElementById('claim-game-btn').disabled = true;
    }
    
    function handleGameCellClick(cell, index) {
        if (cell.style.opacity === '0.5') return;
        
        const value = cell.dataset.value;
        let score = 1;
        
        // –†–∞–∑–Ω—ã–µ –æ—á–∫–∏ –∑–∞ —Ä–∞–∑–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
        if (value === 'üåü') score = 2;
        if (value === 'üíé') score = 3;
        if (value === 'üéØ') score = 5;
        
        gameScore += score;
        cell.style.opacity = '0.5';
        cell.style.transform = 'scale(0.8)';
        cell.style.background = 'rgba(255, 215, 0, 0.3)';
        
        document.getElementById('game-score').textContent = gameScore;
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –∫–ª–∏–∫–∞
        const anim = document.createElement('div');
        anim.className = 'tap-animation';
        anim.innerText = `+${score}`;
        anim.style.left = cell.getBoundingClientRect().left + 'px';
        anim.style.top = cell.getBoundingClientRect().top + 'px';
        document.body.appendChild(anim);
        setTimeout(() => anim.remove(), 1000);
        
        // –í–∏–±—Ä–∞—Ü–∏—è
        try {
            if (tg?.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('soft');
            }
        } catch (e) {}
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–≥—Ä–∞–¥—É
        if (gameScore >= 20) {
            document.getElementById('claim-game-btn').disabled = false;
            if (gameScore === 20) {
                showNotification('üéØ –ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ! –ú–æ–∂–µ—Ç–µ –∑–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É.', 'success');
            }
        }
        
        // –°–ª—É—á–∞–π–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —è—á–µ–π–∫–∏
        setTimeout(() => {
            if (Math.random() > 0.7 && cell.style.opacity === '0.5') {
                cell.style.opacity = '1';
                cell.style.transform = 'scale(1)';
                cell.style.background = '';
                gameScore -= score;
                document.getElementById('game-score').textContent = gameScore;
            }
        }, 3000 + Math.random() * 2000);
    }
    
    function claimGameRewards() {
        if (gameScore >= 20) {
            const reward = gameScore * 10;
            const zooReward = gameScore * 0.001;
            
            state.bones += reward;
            state.zoo += zooReward;
            
            showNotification(`üéÅ –ü–æ–ª—É—á–µ–Ω–æ: ${reward} ü¶¥ –∏ ${zooReward.toFixed(4)} $ZOO`, 'success');
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–≥—Ä—É
            initGame();
            
            updateUI();
            saveGame();
        }
    }
    
    function resetGame() {
        initGame();
        showNotification('–ò–≥—Ä–∞ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–∞!', 'success');
    }
    
    // ==================== –ï–ñ–ï–î–ù–ï–í–ù–´–ï –ù–ê–ì–†–ê–î–´ ====================
    
    function loadDailyRewards() {
        try {
            const saved = localStorage.getItem('zootopia_daily');
            if (saved) {
                dailyRewardsClaimed = JSON.parse(saved);
            }
        } catch (e) {
            console.log('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –Ω–∞–≥—Ä–∞–¥:', e);
        }
        
        updateDailyRewardsUI();
    }
    
    function updateDailyRewardsUI() {
        const today = new Date().toDateString();
        const lastClaim = localStorage.getItem('last_daily_claim');
        const streak = parseInt(localStorage.getItem('daily_streak') || '0');
        
        document.getElementById('current-streak').textContent = streak;
        document.getElementById('day-streak').textContent = streak;
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–µ—Ä–∏—é –µ—Å–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∏ –¥–µ–Ω—å
        if (lastClaim && lastClaim !== today) {
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            
            if (lastClaim !== yesterday.toDateString()) {
                localStorage.setItem('daily_streak', '0');
                dailyRewardsClaimed = [];
                localStorage.setItem('zootopia_daily', JSON.stringify([]));
            }
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–Ω–µ–π
        for (let i = 1; i <= 7; i++) {
            const dayElement = document.getElementById('day' + i);
            if (!dayElement) continue;
            
            dayElement.classList.remove('claimed', 'today');
            
            if (dailyRewardsClaimed.includes(i)) {
                dayElement.classList.add('claimed');
                dayElement.innerHTML = `<div>–î–µ–Ω—å ${i}</div><div>‚úÖ</div>`;
            } else if (i === streak + 1 && lastClaim !== today) {
                dayElement.classList.add('today');
                dayElement.innerHTML = `<div>–î–µ–Ω—å ${i}</div><div>${dailyRewards[i-1]} ü¶¥</div>`;
            } else {
                dayElement.innerHTML = `<div>–î–µ–Ω—å ${i}</div><div>${dailyRewards[i-1]} ü¶¥</div>`;
            }
        }
    }
    
    function showDailyRewards() {
        showTab('tab-daily');
        updateDailyRewardsUI();
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞–∑–∞–¥" –≤ Telegram
        if (tg) {
            tg.BackButton.show();
        }
    }
    
    function claimDaily(day) {
        const today = new Date().toDateString();
        const lastClaim = localStorage.getItem('last_daily_claim');
        const streak = parseInt(localStorage.getItem('daily_streak') || '0');
        
        if (lastClaim === today) {
            showNotification('–í—ã —É–∂–µ –ø–æ–ª—É—á–∞–ª–∏ –Ω–∞–≥—Ä–∞–¥—É —Å–µ–≥–æ–¥–Ω—è!', 'warning');
            return;
        }
        
        if (day !== streak + 1) {
            showNotification(`–°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∏—Ç–µ –Ω–∞–≥—Ä–∞–¥—É –∑–∞ –¥–µ–Ω—å ${streak + 1}`, 'error');
            return;
        }
        
        const reward = dailyRewards[day - 1] || 100;
        state.bones += reward;
        state.zoo += reward * 0.001;
        
        dailyRewardsClaimed.push(day);
        
        try {
            localStorage.setItem('zootopia_daily', JSON.stringify(dailyRewardsClaimed));
            localStorage.setItem('last_daily_claim', today);
            localStorage.setItem('daily_streak', streak + 1);
        } catch (e) {
            console.log('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –Ω–∞–≥—Ä–∞–¥—ã:', e);
        }
        
        showNotification(`üéÅ –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞: ${reward} ü¶¥`, 'success');
        
        updateDailyRewardsUI();
        updateUI();
        saveGame();
    }
    
    // ==================== –†–ï–§–ï–†–ê–õ–¨–ù–ê–Ø –°–ò–°–¢–ï–ú–ê ====================
    
    function handleReferral(refCode) {
        if (refCode === state.referralCode) {
            showNotification('–ù–µ–ª—å–∑—è –ø—Ä–∏–≥–ª–∞—Å–∏—Ç—å —Å–∞–º–æ–≥–æ —Å–µ–±—è!', 'warning');
            return;
        }
        
        try {
            const referrals = JSON.parse(localStorage.getItem('zootopia_referrals') || '{}');
            
            if (!referrals[refCode]) {
                referrals[refCode] = true;
                localStorage.setItem('zootopia_referrals', JSON.stringify(referrals));
                
                // –ù–∞–≥—Ä–∞–¥–∞ –∑–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–∞
                state.bones += 1000;
                state.referrals++;
                
                showNotification('üéâ –í—ã –∑–∞—à–ª–∏ –ø–æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–µ! +1000 ü¶¥', 'success');
                
                updateUI();
                saveGame();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
                if (state.referrals === 5 && !state.achievements.includes('referral_master')) {
                    unlockAchievement('referral_master');
                }
            }
        } catch (e) {
            console.log('–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ—Ñ–µ—Ä–∞–ª–∞:', e);
        }
    }
    
    function copyReferralLink() {
        const link = document.getElementById('referral-link').textContent;
        
        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(link).then(() => {
                showNotification('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!', 'success');
            }).catch(err => {
                fallbackCopyText(link);
            });
        } else {
            fallbackCopyText(link);
        }
    }
    
    function fallbackCopyText(text) {
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        
        try {
            document.execCommand('copy');
            showNotification('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!', 'success');
        } catch (err) {
            showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É', 'error');
        }
        
        document.body.removeChild(textArea);
    }
    
    // ==================== TON –ö–û–®–ï–õ–ï–ö ====================
    
    function connectWallet() {
        try {
            if (tonConnectUI) {
                tonConnectUI.openModal();
            } else {
                showNotification('TON Connect –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', 'error');
            }
        } catch (e) {
            console.log('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞:', e);
            showNotification('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞', 'error');
        }
    }
    
    function updateWalletInfo() {
        const wallet = tonConnectUI.wallet;
        if (wallet) {
            console.log('–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ—à–µ–ª—å–∫–µ:', wallet);
            
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ—à–µ–ª—å–∫–æ–º
            // –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞, –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏ —Ç.–¥.
        }
    }
    
    // ==================== UI –§–£–ù–ö–¶–ò–ò ====================
    
    function showTab(tabId, element) {
        // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
        document.querySelectorAll('.tab-panel').forEach(tab => {
            tab.classList.remove('active');
        });
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
        const tab = document.getElementById(tabId);
        if (tab) {
            tab.classList.add('active');
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é
        if (element) {
            document.querySelectorAll('.nav-item').forEach(nav => {
                nav.classList.remove('active');
            });
            element.classList.add('active');
        } else {
            // –î–ª—è –≤–∫–ª–∞–¥–∫–∏ daily –æ–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é
            if (tabId === 'tab-daily') {
                document.querySelectorAll('.nav-item').forEach(nav => {
                    nav.classList.remove('active');
                });
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–≥—Ä—É –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∫–ª–∞–¥–∫–∏ —Å –∏–≥—Ä–æ–π
        if (tabId === 'tab-game') {
            initGame();
        }
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–æ–π "–ù–∞–∑–∞–¥" –≤ Telegram
        if (tg) {
            if (tabId === 'tab-daily') {
                tg.BackButton.show();
            } else {
                tg.BackButton.hide();
            }
        }
    }
    
    function updateUI() {
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
        document.getElementById('bones').textContent = Math.floor(state.bones).toLocaleString();
        document.getElementById('zoo-val').textContent = state.zoo.toFixed(4);
        document.getElementById('en-cur').textContent = Math.floor(state.energy);
        document.getElementById('en-fill').style.width = (state.energy / 10) + '%';
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —É–ª—É—á—à–µ–Ω–∏—è
        document.getElementById('tap-lvl').textContent = state.tapLvl;
        document.getElementById('tap-power').textContent = getTapPower();
        document.getElementById('energy-lvl').textContent = state.energyLvl;
        
        const tapCost = upgradeCosts.tap[state.tapLvl - 1] || state.tapLvl * 500;
        const energyCost = upgradeCosts.energy[state.energyLvl - 1] || state.energyLvl * 1000;
        
        document.getElementById('tap-price').textContent = tapCost.toLocaleString() + ' ü¶¥';
        document.getElementById('energy-price').textContent = energyCost.toLocaleString() + ' ü¶¥';
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —É—Ä–æ–≤–µ–Ω—å
        document.getElementById('level').textContent = state.level;
        const expNeeded = state.level * 1000;
        const expPercent = Math.min(100, (state.exp / expNeeded) * 100);
        document.getElementById('level-fill').style.width = expPercent + '%';
        document.getElementById('level-progress').textContent = 
            Math.floor(state.exp).toLocaleString() + '/' + expNeeded.toLocaleString();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º NFT –∫–Ω–æ–ø–∫–∏
        ['glasses', 'hat', 'crown'].forEach(id => {
            const button = document.getElementById('buy-' + id);
            if (button) {
                if (state.ownedNFTs.includes(id)) {
                    button.innerHTML = '<i class="fas fa-check"></i> –ù–∞–¥–µ—Ç–æ';
                    button.disabled = true;
                    button.style.background = 'linear-gradient(135deg, #4CAF50, #2E7D32)';
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º NFT
                    const overlay = document.getElementById('nft-' + id);
                    if (overlay) {
                        overlay.classList.add('visible');
                    }
                } else {
                    button.innerHTML = '–ö—É–ø–∏—Ç—å';
                    button.disabled = false;
                    button.style.background = 'linear-gradient(135deg, var(--gold), #FF8D29)';
                    
                    // –°–∫—Ä—ã–≤–∞–µ–º NFT
                    const overlay = document.getElementById('nft-' + id);
                    if (overlay) {
                        overlay.classList.remove('visible');
                    }
                }
            }
        });
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ø
        updateTopList();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —ç–≤–æ–ª—é—Ü–∏—é
        checkEvolution();
    }
    
    function showNotification(message, type = 'success') {
        const notification = document.getElementById('notification');
        if (!notification) return;
        
        notification.textContent = message;
        notification.className = 'notification';
        
        switch(type) {
            case 'success':
                notification.style.background = 'rgba(76, 175, 80, 0.9)';
                break;
            case 'error':
                notification.style.background = 'rgba(244, 67, 54, 0.9)';
                break;
            case 'warning':
                notification.style.background = 'rgba(255, 141, 41, 0.9)';
                break;
        }
        
        notification.classList.add('active');
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ
        clearTimeout(notification.hideTimeout);
        notification.hideTimeout = setTimeout(() => {
            notification.classList.remove('active');
        }, 3000);
    }
    
    function showModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.classList.add('active');
        }
    }
    
    function hideModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.classList.remove('active');
        }
    }
    
    // ==================== –°–û–•–†–ê–ù–ï–ù–ò–ï –ò –ó–ê–ì–†–£–ó–ö–ê ====================
    
    function saveGame() {
        try {
            localStorage.setItem('zootopia_save', JSON.stringify(state));
            console.log('–ò–≥—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞');
        } catch (e) {
            console.log('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', e);
        }
    }
    
    function loadGame() {
        try {
            const saved = localStorage.getItem('zootopia_save');
            if (saved) {
                const loaded = JSON.parse(saved);
                state = { ...state, ...loaded };
                console.log('–ò–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º NFT
                state.ownedNFTs.forEach(id => {
                    const overlay = document.getElementById('nft-' + id);
                    if (overlay) {
                        overlay.classList.add('visible');
                    }
                });
            }
        } catch (e) {
            console.log('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', e);
        }
    }
    
    // ==================== –¢–û–ü –ò–ì–†–û–ö–û–í ====================
    
    function updateTopList() {
        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
        // –î–ª—è –¥–µ–º–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–≥–ª—É—à–∫—É —Å —Ä–∞–Ω–¥–æ–º–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
        
        const userRank = Math.max(1, Math.floor(Math.random() * 50) + 1);
        document.getElementById('user-rank').textContent = '#' + userRank;
    }
    
    function loadTop(type) {
        const topList = document.getElementById('top-list');
        const typeName = type === 'bones' ? '–∫–æ—Å—Ç—è–º' : type === 'zoo' ? '$ZOO' : '—Å–∏–ª–µ —Ç–∞–ø–∞';
        
        topList.innerHTML = `
            <div class="card">
                <div style="text-align: center; padding: 20px;">
                    <i class="fas fa-sync fa-spin" style="font-size: 24px; margin-bottom: 10px;"></i>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–ø ${typeName}...</p>
                </div>
            </div>
        `;
        
        // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
        setTimeout(() => {
            updateTopList();
        }, 1000);
    }
    
    // ==================== –≠–ö–°–ü–û–†–¢ –î–õ–Ø –ì–õ–û–ë–ê–õ–¨–ù–û–ì–û –î–û–°–¢–£–ü–ê ====================
    window.handleTap = handleTap;
    window.upgradeTap = upgradeTap;
    window.upgradeEnergy = upgradeEnergy;
    window.buyNFT = buyNFT;
    window.showTab = showTab;
    window.initGame = initGame;
    window.claimGameRewards = claimGameRewards;
    window.resetGame = resetGame;
    window.showDailyRewards = showDailyRewards;
    window.claimDaily = claimDaily;
    window.connectWallet = connectWallet;
    window.copyReferralLink = copyReferralLink;
    window.updateTopList = updateTopList;
    window.loadTop = loadTop;
    window.hideModal = hideModal;
</script>
</body>
</html>
